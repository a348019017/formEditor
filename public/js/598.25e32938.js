"use strict";(self["webpackChunkpmap_cesium"]=self["webpackChunkpmap_cesium"]||[]).push([[598],{99598:function(e,t,i){i.r(t),i.d(t,{default:function(){return d}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"popuBox"},[t("div",{staticStyle:{height:"100%",width:"90%",padding:"45px 15px"}},[t("el-collapse",{on:{change:e.handleChange},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},e._l(e.forms,(function(i){return t("el-collapse-item",{key:i.guid,attrs:{title:i.FormTemplate.title,name:i.FormTemplate.name}},[t("VueForm",{ref:"form",refInFor:!0,attrs:{schema:i.FormTemplate.template,formProps:{labelPosition:"left"},formFooter:{okBtn:"提交",cancelBtn:"取消"}},on:{"on-cancel":e.onCancel},model:{value:i.data,callback:function(t){e.$set(i,"data",t)},expression:"item.data"}})],1)})),1)],1),t("div",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("提交")])],1)])},o=[],r=i(10723),n=i(79543),s=i(83986),m={name:"ConfigForms",components:{VueForm:r.ZP},inject:["eventHub"],data(){return{ispushed:!1,showforms:!0,activeNames:"",defaultValues:{},forms:[{name:"测试form1",guid:"baca1",data:{},FormTemplate:{type:"object",required:["userName","age"],properties:{userName:{type:"string",title:"用户名",default:"Liu.Jun"},age:{type:"number",title:"年龄"},bio:{type:"string",title:"签名",minLength:10,default:"知道的越多、就知道的越少","ui:options":{placeholder:"请输入你的签名",type:"textarea",rows:1}},imgUrlList:{title:"图片上传",type:"array","ui:widget":"UploadWidget","ui:action":"https://run.mocky.io/v3/78638190-1adb-4d32-8f6e-400068ffe286",default:[],items:{type:"string"}}}},uiSchema:{}}]}},mounted(){window.onSubmit=this.onSubmit.bind(this),this.eventHub.$on("clickformedit",this.onclick);let e=this.$route.params.group,t=this;if(e)return(0,n.VT)(1,10,e).then((e=>{if(!e.isok)throw"no data";if(!e.data||!e.data.length)throw"no data";this.forms=e.data,this.forms&&this.forms.length>0&&(t.activeNames=this.forms[0].FormTemplate.name)})).catch((e=>{t.getTemplate()})),void(window.formguid=e)},methods:{getTemplate(){let e=this,t=this.$route.query.group;t&&(0,n.oZ)(t).then((t=>{if(t.isok){if(!window.formguid){let e=(0,n.xD)();window.formguid=e}this.forms=t.data.map((t=>{let i=e.setDefaultValue(t.template.properties);return{FormTemplate:t,data:i,name:(0,n.xD)(),group:window.formguid,FormTemplateId:t.id}})),this.forms&&this.forms.length>0&&(e.activeNames=this.forms[0].FormTemplate.name)}}))},setDefaultValue(e){let t={};window.android.getSpotInterpretationInfo||alert("未查找到getSpotInterpretationInfo方法");let i=window.android.getSpotInterpretationInfo();return i="string"==typeof i?JSON.parse(i):i,Object.keys(e).forEach((e=>{i[e]&&(t[e]=i[e])})),t},handleChange(){},onCancel(){this.eventHub.$emit("clickform",!0)},onSubmit(){let e=!0;this.$refs.form.forEach((t=>{t.$refs.genEditForm.validate(((t,i)=>{e=e&&t}))}));if(e){if(window.android.submitResultInfo){let e=this.forms.map((e=>e.data));e=Object.assign({},...e),window.android.submitResultInfo(e)}(0,n.R2)(this.forms).then((e=>{e.isok?((0,s.Z)({type:"primary",message:"提交成功！"}),(0,n.cT)(this.formData).then((e=>{this.eventHub.$emit("clickform",!0)}))):(0,s.Z)({type:"primary",message:"提交失败！"})}))}else(0,s.Z)({type:"primary",message:"请补充表单！"})},handlecloseicon(){this.eventHub.$emit("clickform",!0)},onclick(e){this.showforms=!this.showforms,e&&(this.formData=e)}},watch:{formData:{handler:function(e,t){},deep:!0}},beforeDestroy(){this.eventHub.$off("clickformedit",this.onclick)}},l=m,u=i(62349),f=(0,u.Z)(l,a,o,!1,null,"9ab47884",null),d=f.exports}}]);
//# sourceMappingURL=598.25e32938.js.map